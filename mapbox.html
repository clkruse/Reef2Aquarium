<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title></title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="css/font-awesome.min.css" rel="stylesheet" type="text/css" media="all">
        <link href="css/themify-icons.css" rel="stylesheet" type="text/css" media="all" />
        <link href="css/bootstrap.css" rel="stylesheet" type="text/css" media="all" />
        <link href="css/flexslider.css" rel="stylesheet" type="text/css" media="all" />
        <link href="css/lightbox.min.css" rel="stylesheet" type="text/css" media="all" />
        <link href="css/theme.css" rel="stylesheet" type="text/css" media="all" />
        <link href="css/custom.css" rel="stylesheet" type="text/css" media="all" />
        <link href='http://fonts.googleapis.com/css?family=Lato:300,400%7CRaleway:100,400,300,500,600,700%7COpen+Sans:400,500,600' rel='stylesheet' type='text/css'>
        <link href="http://fonts.googleapis.com/css?family=Titillium+Web:100,300,400,600,700" rel="stylesheet" type="text/css">
        <link href="css/font-raleway.css" rel="stylesheet" type="text/css">
        <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.33.0/mapbox-gl.js'></script>

        <style>
            body { margin:0; padding:0; }
            #map { position:absolute; top:0; bottom:0; width:100%; }
        </style>

    </head>

    <body>
    <style>
      /* Mobile Style */
      @media all and (max-width: 620px) {
        #map {
            position: fixed;
            height:50%;
        }
        #features {
            position: absolute;
            bottom: 0px;
            font-family: sans-serif;
            overflow-y: scroll;
            height: 50vh;
            background-color: #fafafa;
        }
        section {
            padding:  25px 25px;
            padding-top: 80px;
            line-height: 20px;
            /* Optional card bottom border border-bottom: 1px solid #ddd; */
            opacity: 0.45;
            font-size: 13px;
        }
        section.active {
            opacity: 1;
        }
        section:last-child {
            border-bottom: none;
            margin-bottom: 30vh;
        }
      }
      /* Desktop (widescreen) Style */
      @media all and (min-width: 620px) {
        #map {
            position: fixed;
            width:70%;
        }
        #features {
            position:absolute;
            right: 0px;
            font-family: sans-serif;
            overflow-y: scroll;
            width: 30%;
            background-color: #fafafa;
        }

        section {
            padding:  25px 25px;
            padding-top: 100px;
            line-height: 25px;
            /* Optional card bottom border border-bottom: 1px solid #ddd; */
            opacity: 0.45;
            font-size: 13px;
        }
        section.active {
            opacity: 1;
        }
        section:last-child {
            border-bottom: none;
            margin-bottom: 80vh;
        }
      }
    </style>
    <!-- Navbar
		<div class="">
		    <nav>
		        <div class="nav-bar">
		            <div class="module widget-handle left">
                  <ul class="menu">
                      <li>
                          <a href="index.html">Reef to Aquarium</a>
                      </li>
		                <!-- Optional Logo image in top left corner
                    <a href="index.html">
		                    <img class="logo logo-light" alt="Foundry" src="img/logo-light.png">
		                    <img class="logo logo-dark" alt="Foundry" src="img/logo-dark.png">
		                </a>
                    -->
<!--		            </div>
		            <div class="module widget-handle mobile-toggle right visible-sm visible-xs">
		                <i class="ti-menu"></i>
		            </div>
		            <div class="module-group right">
		                <div class="module left">
		                    <ul class="menu">
		                        <li>
		                            <a href="about.html">The Team</a>
		                        </li>

		                        <li class="has-dropdown">
		                            <a href="stories.html">
		                                Stories
		                            </a>
		                            <ul>
		                                <li>
                                      <a href="mr-su.html">Mr. Su</a>
                                      <a href="#"><strike>Exporter</strike></a>
                                      <a href="fishing.html">Fishing</a>
                                      <a href="#"><strike>Philippines</strike></a>
                                      <a href="#"><strike>Colorado Aquarists</strike></a>
		                                </li>
		                            </ul>
		                        </li>
		                    </ul>
		                </div>
		                <div class="module widget-handle left">
                      <ul class="menu">
                          <li>
                              <a href="map.html">The Map</a>
                          </li>

		                  </ul>
		                </div>
		            </div>
		        </div>
		    </nav>
		</div>
-->

    <div id='map'></div>
    <div id='features'>
      <section id='overview' class='active'>
          <h1>Reef to Aquarium</h1>
          <p>The journey of a blue tang from a small reef in Indonesia, to an aquarist in the mountains of Colorado</p>

      </section>
      <section id='blue-tang-fishing'>
          <h3>Blue Tang Fishing in Toropot</h3>
          <p>Blue Tang fishing. Crazy! Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla non lorem in odio sollicitudin efficitur vitae cursus magna. Aliquam quis lorem eu nisl laoreet feugiat sit amet quis dui. Donec id elit a urna porta faucibus sit amet in nisl. Integer risus urna, euismod quis dapibus eget, facilisis vitae elit. Nullam vehicula, arcu ut molestie condimentum, nulla nisl lacinia metus, vitae lacinia nisi quam non magna. Pellentesque varius purus at libero sagittis sollicitudin.</p>
          <a href="img/IMG_3842.jpg" data-lightbox="true">
            <img alt="Clownfish" src="img/IMG_3821.jpg" class="image-medium">
          </a>
      </section>
      <section id='tang-farm'>
          <h3>Blue Tang Holding Pens</h3>
          <p>After capture, the Blue Tangs are transported to net pens in Bali. Here, they are kept to grow to a larger size.Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla non lorem in odio sollicitudin efficitur vitae cursus magna. Aliquam quis lorem eu nisl laoreet feugiat sit amet quis dui. Donec id elit a urna porta faucibus sit amet in nisl. Integer risus urna, euismod quis dapibus eget, facilisis vitae elit. Nullam vehicula, arcu ut molestie condimentum, nulla nisl lacinia metus, vitae lacinia nisi quam non magna. Pellentesque varius purus at libero sagittis sollicitudin.</p>
          <a href="img/IMG_3842.jpg" data-lightbox="true">
            <img alt="Clownfish" src="img/IMG_3821.jpg" class="image-medium">
          </a>
      </section>
      <section id='middleman'>
          <h3>Middleman</h3>
          <p>After reaching a size threshold, the tangs are taken from the net pens, to sell to a middleman. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla non lorem in odio sollicitudin efficitur vitae cursus magna. Aliquam quis lorem eu nisl laoreet feugiat sit amet quis dui. Donec id elit a urna porta faucibus sit amet in nisl. Integer risus urna, euismod quis dapibus eget, facilisis vitae elit. Nullam vehicula, arcu ut molestie condimentum, nulla nisl lacinia metus, vitae lacinia nisi quam non magna. Pellentesque varius purus at libero sagittis sollicitudin.</p>
          <a href="img/IMG_3842.jpg" data-lightbox="true">
            <img alt="Clownfish" src="img/IMG_3821.jpg" class="image-medium">
          </a>
          <br></br>
          <a href="img/IMG_3842.jpg" data-lightbox="true">
            <img alt="Clownfish" src="img/IMG_3821.jpg" class="image-medium">
          </a>
      </section>
      <section id='bali-airport'>
          <h3>Denpasar International Airport</h3>
          <p>The exporter puts together a shipment of fish packed in small bags, and sends them to the airport.</p>
      </section>
      <section id='double-c'>
          <h3>Double C Exporters</h3>
          <p>he fish are dropped off at Double C fish exporters. The fish are kept here for a few days before their next step. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla non lorem in odio sollicitudin efficitur vitae cursus magna. Aliquam quis lorem eu nisl laoreet feugiat sit amet quis dui. Donec id elit a urna porta faucibus sit amet in nisl. Integer risus urna, euismod quis dapibus eget, facilisis vitae elit. Nullam vehicula, arcu ut molestie condimentum, nulla nisl lacinia metus, vitae lacinia nisi quam non magna. Pellentesque varius purus at libero sagittis sollicitudin.</p>
      </section>
      <section id='los-angeles'>
          <h3>Los Angeles Import</h3>
          <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla non lorem in odio sollicitudin efficitur vitae cursus magna. Aliquam quis lorem eu nisl laoreet feugiat sit amet quis dui. Donec id elit a urna porta faucibus sit amet in nisl. Integer risus urna, euismod quis dapibus eget, facilisis vitae elit. Nullam vehicula, arcu ut molestie condimentum, nulla nisl lacinia metus, vitae lacinia nisi quam non magna. Pellentesque varius purus at libero sagittis sollicitudin.</p>
          <small id="citation">
              A <a href='www.nationalgeographic.com'>National Geographic</a> Project
          </small>
      </section>

    </div>


    <script>
    mapboxgl.accessToken = 'pk.eyJ1IjoiY2xrcnVzZSIsImEiOiJjaXIxY2M2dGcwMnNiZnZtZzN0Znk3MXRuIn0.MyKHSjxjG-ZcI2BkRUSGJA';
    var map = new mapboxgl.Map({
        container: 'map',
        zoom: 2.3,
        center: [171.09, 20.3405],
        style: 'mapbox://styles/clkruse/cizu3laf000a22spid4gcxazp',
        hash: false
    });

    var chapters = {
      'overview': {
          bearing: 0,
          zoom: 2.3,
          center: [171.09, 20.3405],
          pitch: 0
      },
        'blue-tang-fishing': {
            bearing: 0,
            center: [123.470379, -1.941142],
            zoom: 12.5,
            pitch: 0
        },
        'tang-farm': {
            duration: 6000,
            center: [114.60762,-8.128501],
            bearing: 150,
            zoom: 15,
            pitch: 0
        },
        'middleman': {
            bearing: 90,
            center: [114.60862,-8.131501],
            zoom: 13,
            speed: 0.6,
            pitch: 40
        },
        'bali-airport': {
            bearing: 90,
            center: [115.166787,-8.746717],
            zoom: 12.3,
            speed: 0.5
        },
        'double-c': {
            bearing: 90,
            center: [115.178129, -8.725586],
            zoom: 13,
            pitch: 40
        },
        'los-angeles': {
            bearing: 90,
            center: [-118.4085, 33.9416],
            zoom: 10.5,
            pitch: 40
        }
    };

    // On every scroll event, check which element is on screen
    window.onscroll = function() {

        var chapterNames = Object.keys(chapters);
        for (var i = 0; i < chapterNames.length; i++) {
            var chapterName = chapterNames[i];
            if (isElementOnScreen(chapterName)) {
                setActiveChapter(chapterName);

                break;
            }
        }

    };

    features.onscroll = function() {

        var chapterNames = Object.keys(chapters);
        for (var i = 0; i < chapterNames.length; i++) {
            var chapterName = chapterNames[i];
            if (isElementOnScreenMobile(chapterName)) {
                setActiveChapter(chapterName);

                break;
            }
        }

    };

    var activeChapterName = 'overview';

    function setActiveChapter(chapterName) {
        if (chapterName === activeChapterName) return;
        map.flyTo(chapters[chapterName]);
        document.getElementById(chapterName).setAttribute('class', 'active');
        document.getElementById(activeChapterName).setAttribute('class', '');
        activeChapterName = chapterName;
    }

    function isElementOnScreen(id) {
        var element = document.getElementById(id);
        var bounds = element.getBoundingClientRect();
        return bounds.top < window.innerHeight && bounds.bottom > (screen.height/8);
    }
// Need to have separate screen calls for mobile vs. desktop to accomodate diff screen height triggers
    function isElementOnScreenMobile(id) {
        var element = document.getElementById(id);
        var bounds = element.getBoundingClientRect();
        return bounds.top < window.innerHeight && bounds.bottom > (screen.height/2.2);
    }

    </script>

    <script src="js/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/flexslider.min.js"></script>
    <script src="js/masonry.min.js"></script>
    <script src="js/parallax.js"></script>
    <script src="js/scripts.js"></script>
    <script src="js/lightbox.min.js"></script>


      <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-3737359-1', 'auto');
      ga('send', 'pageview');

      </script>
</body>
</html>
